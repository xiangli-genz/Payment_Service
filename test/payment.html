<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>T√†i Li·ªáu Ch√≠nh Th·ª©c - VNPay & MoMo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      color: white;
      margin-bottom: 30px;
    }

    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
    }

    .card {
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      margin-bottom: 25px;
    }

    .section {
      margin-bottom: 30px;
    }

    .section h2 {
      color: #667eea;
      margin-bottom: 20px;
      font-size: 1.8em;
      padding-bottom: 10px;
      border-bottom: 3px solid #667eea;
    }

    .section h3 {
      color: #333;
      margin: 20px 0 15px 0;
      font-size: 1.3em;
    }

    .alert {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      border-left: 4px solid;
    }

    .alert-danger {
      background: #fee2e2;
      border-color: #ef4444;
      color: #991b1b;
    }

    .alert-success {
      background: #d1fae5;
      border-color: #10b981;
      color: #065f46;
    }

    .alert-info {
      background: #dbeafe;
      border-color: #3b82f6;
      color: #1e40af;
    }

    .alert-warning {
      background: #fff3cd;
      border-color: #ffc107;
      color: #856404;
    }

    .credentials-box {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      margin: 15px 0;
      border: 2px solid #667eea;
    }

    .cred-row {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #e0e0e0;
    }

    .cred-row:last-child {
      border-bottom: none;
    }

    .cred-label {
      font-weight: 600;
      color: #666;
      min-width: 200px;
    }

    .cred-value {
      flex: 1;
      font-family: 'Courier New', monospace;
      color: #333;
      word-break: break-all;
    }

    .link-btn {
      display: inline-block;
      padding: 12px 24px;
      background: #667eea;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      transition: all 0.3s;
      margin: 10px 10px 10px 0;
    }

    .link-btn:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
    }

    .link-btn.secondary {
      background: #6c757d;
    }

    .code-block {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
      line-height: 1.6;
      margin: 15px 0;
    }

    .test-card {
      background: white;
      border: 2px solid #10b981;
      border-radius: 10px;
      padding: 20px;
      margin: 15px 0;
    }

    .test-card h4 {
      color: #10b981;
      margin-bottom: 15px;
      font-size: 1.2em;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
      background: white;
    }

    table th,
    table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e0e0e0;
    }

    table th {
      background: #f8f9fa;
      font-weight: 600;
      color: #333;
    }

    table code {
      background: #f8f9fa;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.9em;
    }

    .comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }

    .comparison-card {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      border-left: 4px solid;
    }

    .comparison-card.vnpay {
      border-color: #ef4444;
    }

    .comparison-card.momo {
      border-color: #ec4899;
    }

    .comparison-card h4 {
      margin-bottom: 15px;
      font-size: 1.2em;
    }

    .comparison-card ul {
      list-style: none;
      padding: 0;
    }

    .comparison-card li {
      padding: 8px 0;
      padding-left: 25px;
      position: relative;
    }

    .comparison-card li:before {
      content: "‚úì";
      position: absolute;
      left: 0;
      color: #10b981;
      font-weight: bold;
    }

    .important {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
    }

    @media (max-width: 768px) {
      .comparison {
        grid-template-columns: 1fr;
      }

      .cred-row {
        flex-direction: column;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìö T√†i Li·ªáu Ch√≠nh Th·ª©c</h1>
      <p>VNPay & MoMo Sandbox Testing</p>
    </div>

    <!-- VNPay Section -->
    <div class="card">
      <div class="section">
        <h2>üè¶ VNPay Sandbox</h2>

        <div class="alert alert-success">
          <strong>‚úÖ QUAN TR·ªåNG:</strong> Credentials trong .env c·ªßa b·∫°n l√† <strong>CH√çNH X√ÅC</strong>. ƒê√¢y l√† credentials demo m√† VNPay cung c·∫•p s·∫µn cho testing!
        </div>

        <h3>üîó T√†i Li·ªáu Ch√≠nh Th·ª©c</h3>
        <a href="https://sandbox.vnpayment.vn/apis/docs/" target="_blank" class="link-btn">
          üìñ VNPay API Documentation
        </a>
        <a href="https://sandbox.vnpayment.vn/devreg/" target="_blank" class="link-btn secondary">
          üìù ƒêƒÉng K√Ω Sandbox
        </a>

        <h3>üîë Credentials Demo (ƒê√£ c√≥ trong .env)</h3>
        <div class="credentials-box">
          <div class="cred-row">
            <span class="cred-label">TMN Code:</span>
            <span class="cred-value">DEMOV210</span>
          </div>
          <div class="cred-row">
            <span class="cred-label">Hash Secret:</span>
            <span class="cred-value">RAOEXHYVSDDIIENYWSLDIIZTANXUXZFJ</span>
          </div>
          <div class="cred-row">
            <span class="cred-label">URL:</span>
            <span class="cred-value">https://sandbox.vnpayment.vn/paymentv2/vpcpay.html</span>
          </div>
          <div class="cred-row">
            <span class="cred-label">Algorithm:</span>
            <span class="cred-value">HMAC-SHA512</span>
          </div>
          <div class="cred-row">
            <span class="cred-label">Version:</span>
            <span class="cred-value">2.1.0</span>
          </div>
        </div>

        <div class="alert alert-info">
          Credentials n√†y l√† <strong>public demo account</strong> do VNPay cung c·∫•p. B·∫•t k·ª≥ ai c≈©ng c√≥ th·ªÉ d√πng ƒë·ªÉ test.
        </div>

        <h3>üí≥ Th·∫ª Test</h3>
        <div class="test-card">
          <h4>üè¶ Th·∫ª NCB (Khuy·∫øn ngh·ªã)</h4>
          <table>
            <tr>
              <td><strong>S·ªë th·∫ª:</strong></td>
              <td><code>9704198526191432198</code></td>
            </tr>
            <tr>
              <td><strong>T√™n ch·ªß th·∫ª:</strong></td>
              <td><code>NGUYEN VAN A</code></td>
            </tr>
            <tr>
              <td><strong>Ng√†y ph√°t h√†nh:</strong></td>
              <td><code>07/15</code></td>
            </tr>
            <tr>
              <td><strong>OTP:</strong></td>
              <td><code>123456</code></td>
            </tr>
          </table>
        </div>

        <div class="test-card">
          <h4>üí≥ Th·∫ª Kh√°c</h4>
          <table>
            <thead>
              <tr>
                <th>Ng√¢n H√†ng</th>
                <th>S·ªë Th·∫ª</th>
                <th>T√™n</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Vietcombank</td>
                <td><code>9704060083651234567</code></td>
                <td>NGUYEN VAN A</td>
              </tr>
              <tr>
                <td>Vietinbank</td>
                <td><code>9704100221234567892</code></td>
                <td>NGUYEN VAN A</td>
              </tr>
              <tr>
                <td>Visa Test</td>
                <td><code>4111111111111111</code></td>
                <td>NGUYEN VAN A</td>
              </tr>
            </tbody>
          </table>
          <p style="margin-top: 10px; color: #666;">
            <strong>OTP:</strong> <code>123456</code> cho t·∫•t c·∫£ th·∫ª
          </p>
        </div>

        <h3>‚öôÔ∏è C·∫•u H√¨nh Quan Tr·ªçng</h3>
        <div class="important">
          <h4 style="margin-bottom: 10px;">üéØ L·ªói "Invalid data format" c√≥ th·ªÉ do:</h4>
          <ol style="padding-left: 20px; margin-top: 10px;">
            <li><strong>Amount ph·∫£i nh√¢n 100:</strong> ƒê·ªÉ g·ª≠i 50.000ƒë, g·ª≠i <code>5000000</code></li>
            <li><strong>Timezone:</strong> Ph·∫£i d√πng <code>Asia/Ho_Chi_Minh</code></li>
            <li><strong>Format CreateDate:</strong> <code>YYYYMMDDHHmmss</code> (v√≠ d·ª•: 20260112143000)</li>
            <li><strong>Params ph·∫£i sort:</strong> Theo alphabet tr∆∞·ªõc khi t·∫°o signature</li>
            <li><strong>Encoding:</strong> D√πng <code>{ encode: false }</code> khi t·∫°o query string</li>
          </ol>
        </div>

        <h3>üß™ Test Flow</h3>
        <div class="code-block">
1. User ch·ªçn thanh to√°n VNPay
2. Backend t·∫°o payment URL v·ªõi params ƒë√£ sign
3. Redirect user t·ªõi VNPay
4. User ch·ªçn ng√¢n h√†ng NCB
5. Nh·∫≠p s·ªë th·∫ª: 9704198526191432198
6. Nh·∫≠p t√™n: NGUYEN VAN A
7. Nh·∫≠p ng√†y: 07/15
8. Nh·∫≠p OTP: 123456
9. VNPay redirect v·ªÅ VNPAY_RETURN_URL
10. Backend verify signature v√† c·∫≠p nh·∫≠t payment
        </div>
      </div>
    </div>

    <!-- MoMo Section -->
    <div class="card">
      <div class="section">
        <h2>üí∞ MoMo Sandbox</h2>

        <div class="alert alert-warning">
          <strong>‚ö†Ô∏è KH√ÅC BI·ªÜT:</strong> MoMo credentials trong .env l√† <strong>demo public</strong>, nh∆∞ng b·∫°n c·∫ßn <strong>t√†i kho·∫£n MoMo test ri√™ng</strong> ƒë·ªÉ thanh to√°n.
        </div>

        <h3>üîó T√†i Li·ªáu Ch√≠nh Th·ª©c</h3>
        <a href="https://developers.momo.vn/v3/" target="_blank" class="link-btn">
          üìñ MoMo Developers Portal
        </a>
        <a href="https://developers.momo.vn/v3/docs/payment/onboarding/test-instructions/" target="_blank" class="link-btn">
          üß™ Test Instructions
        </a>
        <a href="https://developers.momo.vn/v3/download/" target="_blank" class="link-btn secondary">
          üì± Download MoMo Test App
        </a>

        <h3>üîë Credentials Demo (ƒê√£ c√≥ trong .env)</h3>
        <div class="credentials-box">
          <div class="cred-row">
            <span class="cred-label">Partner Code:</span>
            <span class="cred-value">MOMOBKUN20180529</span>
          </div>
          <div class="cred-row">
            <span class="cred-label">Access Key:</span>
            <span class="cred-value">klm05TvNBzhg7h7j</span>
          </div>
          <div class="cred-row">
            <span class="cred-label">Secret Key:</span>
            <span class="cred-value">at67qH6mk8w5Y1nAyMoYKMWACiEi2bsa</span>
          </div>
          <div class="cred-row">
            <span class="cred-label">Endpoint:</span>
            <span class="cred-value">https://test-payment.momo.vn/v2/gateway/api/create</span>
          </div>
          <div class="cred-row">
            <span class="cred-label">Algorithm:</span>
            <span class="cred-value">HMAC-SHA256</span>
          </div>
        </div>

        <h3>üì± T·∫°o T√†i Kho·∫£n Test</h3>
        <div class="alert alert-danger">
          <strong>üö® B·∫ÆT BU·ªòC:</strong> Ph·∫£i download <strong>MoMo Test App</strong> (kh√¥ng ph·∫£i app MoMo b√¨nh th∆∞·ªùng t·ª´ CH Play/App Store)
        </div>

        <div class="important">
          <h4>üì≤ C√°c B∆∞·ªõc T·∫°o T√†i Kho·∫£n Test:</h4>
          <ol style="padding-left: 20px; margin-top: 10px; line-height: 1.8;">
            <li><strong>G·ª° MoMo production app</strong> n·∫øu ƒë√£ c√†i t·ª´ CH Play/App Store</li>
            <li><strong>Download MoMo Test App</strong> t·ª´ link tr√™n</li>
            <li><strong>C√†i ƒë·∫∑t</strong> MoMo Test App (c·∫ßn allow install from unknown sources tr√™n Android)</li>
            <li><strong>M·ªü app</strong> v√† ƒëƒÉng k√Ω t√†i kho·∫£n m·ªõi:
              <ul style="margin-top: 8px; padding-left: 20px;">
                <li>Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i b·∫•t k·ª≥ (10 s·ªë, n√™n d√πng prefix th·∫≠t nh∆∞ 090, 091,...)</li>
                <li>OTP: <code>000000</code> ho·∫∑c <code>0000</code></li>
                <li>ƒê·∫∑t m·∫≠t kh·∫©u 6 s·ªë</li>
                <li>ƒêi·ªÅn th√¥ng tin: H·ªç t√™n, Email, Gi·ªõi t√≠nh, Qu·ªëc t·ªãch (ch·ªçn Vietnam)</li>
              </ul>
            </li>
            <li><strong>Li√™n k·∫øt th·∫ª ATM:</strong>
              <ul style="margin-top: 8px; padding-left: 20px;">
                <li>V√†o "V√≠ c·ªßa t√¥i" ‚Üí "Qu·∫£n l√Ω t√†i kho·∫£n li√™n k·∫øt"</li>
                <li>Ch·ªçn ng√¢n h√†ng <strong>Agribank</strong></li>
                <li>S·ªë th·∫ª: <code>9704 05XX XXXX XXXX</code> (X l√† s·ªë b·∫•t k·ª≥ 0-9)</li>
                <li>T√™n ch·ªß th·∫ª: T√™n c·ªßa b·∫°n</li>
                <li>Ng√†y ph√°t h√†nh: B·∫•t k·ª≥</li>
              </ul>
            </li>
            <li><strong>N·∫°p ti·ªÅn test:</strong> V·ªÅ m√†n h√¨nh ch√≠nh ‚Üí N·∫°p ti·ªÅn ‚Üí Nh·∫≠p s·ªë ti·ªÅn ‚Üí M·∫≠t kh·∫©u ‚Üí OTP (n·∫øu c√≥)</li>
          </ol>
        </div>

        <h3>üìã T√†i Kho·∫£n Test S·∫µn (N·∫øu mu·ªën d√πng)</h3>
        <table>
          <thead>
            <tr>
              <th>Tr∆∞·ªùng</th>
              <th>Gi√° Tr·ªã</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>S·ªë ƒëi·ªán tho·∫°i</td>
              <td>T·∫°o m·ªõi theo h∆∞·ªõng d·∫´n tr√™n</td>
            </tr>
            <tr>
              <td>M·∫≠t kh·∫©u</td>
              <td><code>000000</code></td>
            </tr>
            <tr>
              <td>OTP</td>
              <td><code>000000</code></td>
            </tr>
          </tbody>
        </table>

        <h3>‚öôÔ∏è C·∫•u H√¨nh Callback</h3>
        <div class="alert alert-danger">
          <strong>üö® QUAN TR·ªåNG:</strong> MoMo y√™u c·∫ßu callback URL ph·∫£i <strong>HTTPS v√† public</strong>. Kh√¥ng ch·∫•p nh·∫≠n localhost!
        </div>

        <div class="important">
          <h4>üåê Setup Ngrok:</h4>
          <div class="code-block" style="margin-top: 10px;">
# 1. C√†i ngrok
npm install -g ngrok

# 2. Ch·∫°y ngrok
ngrok http 3003

# 3. Copy URL (vd: https://abc-xyz.ngrok-free.dev)

# 4. C·∫≠p nh·∫≠t .env
MOMO_CALLBACK_URL=https://abc-xyz.ngrok-free.dev/api/payments/callback/momo
          </div>
        </div>

        <h3>üß™ Test Flow</h3>
        <div class="code-block">
1. ƒê·∫£m b·∫£o ngrok ƒëang ch·∫°y v√† .env ƒë√£ update
2. User ch·ªçn thanh to√°n MoMo
3. Backend t·∫°o payment request ‚Üí nh·∫≠n payUrl
4. User ƒë∆∞·ª£c redirect t·ªõi trang MoMo
5. M·ªü MoMo Test App tr√™n ƒëi·ªán tho·∫°i
6. Qu√©t QR code ho·∫∑c nh·∫≠p m√£ thanh to√°n
7. Nh·∫≠p m·∫≠t kh·∫©u (000000)
8. X√°c nh·∫≠n thanh to√°n
9. MoMo g·ª≠i IPN callback t·ªõi ngrok URL
10. Backend verify v√† c·∫≠p nh·∫≠t payment
        </div>
      </div>
    </div>

    <!-- Comparison -->
    <div class="card">
      <div class="section">
        <h2>üìä So S√°nh VNPay vs MoMo</h2>

        <div class="comparison">
          <div class="comparison-card vnpay">
            <h4>üè¶ VNPay - D·ªÖ Test</h4>
            <ul>
              <li>Kh√¥ng c·∫ßn app ri√™ng</li>
              <li>Credentials demo public</li>
              <li>Th·∫ª test c√≥ s·∫µn</li>
              <li>OTP c·ªë ƒë·ªãnh: 123456</li>
              <li>Return URL cho ph√©p localhost</li>
              <li>Test tr·ª±c ti·∫øp tr√™n browser</li>
            </ul>
          </div>

          <div class="comparison-card momo">
            <h4>üí∞ MoMo - Ph·ª©c T·∫°p H∆°n</h4>
            <ul>
              <li>C·∫ßn MoMo Test App ri√™ng</li>
              <li>Ph·∫£i t·∫°o t√†i kho·∫£n test</li>
              <li>C·∫ßn ƒëi·ªán tho·∫°i ƒë·ªÉ qu√©t QR</li>
              <li>Callback URL ph·∫£i public (ngrok)</li>
              <li>Setup ph·ª©c t·∫°p h∆°n</li>
              <li>Nh∆∞ng gi·ªëng m√¥i tr∆∞·ªùng th·∫≠t h∆°n</li>
            </ul>
          </div>
        </div>

        <div class="alert alert-info" style="margin-top: 20px;">
          <strong>üí° Khuy·∫øn ngh·ªã:</strong> B·∫Øt ƒë·∫ßu test v·ªõi <strong>VNPay</strong> tr∆∞·ªõc v√¨ ƒë∆°n gi·∫£n h∆°n. Sau ƒë√≥ m·ªõi test MoMo khi ƒë√£ hi·ªÉu r√µ flow.
        </div>
      </div>
    </div>

    <!-- Troubleshooting -->
    <div class="card">
      <div class="section">
        <h2>üîß Kh·∫Øc Ph·ª•c L·ªói</h2>

        <h3>VNPay - "Invalid data format"</h3>
        <table>
          <thead>
            <tr>
              <th>Nguy√™n Nh√¢n</th>
              <th>Gi·∫£i Ph√°p</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Amount kh√¥ng ƒë√∫ng format</td>
              <td>Nh√¢n 100: <code>50000 ‚Üí 5000000</code></td>
            </tr>
            <tr>
              <td>CreateDate kh√¥ng ƒë√∫ng timezone</td>
              <td>D√πng <code>moment().tz('Asia/Ho_Chi_Minh')</code></td>
            </tr>
            <tr>
              <td>Params kh√¥ng sort</td>
              <td>Sort theo alphabet tr∆∞·ªõc khi sign</td>
            </tr>
            <tr>
              <td>Signature sai</td>
              <td>Ki·ªÉm tra VNPAY_HASH_SECRET trong .env</td>
            </tr>
            <tr>
              <td>Query string b·ªã encode</td>
              <td>D√πng <code>{ encode: false }</code></td>
            </tr>
          </tbody>
        </table>

        <h3>MoMo - "Giao d·ªãch kh√¥ng t·ªìn t·∫°i"</h3>
        <table>
          <thead>
            <tr>
              <th>Nguy√™n Nh√¢n</th>
              <th>Gi·∫£i Ph√°p</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>RequestId kh√¥ng unique</td>
              <td>Th√™m timestamp: <code>${orderId}_${Date.now()}</code></td>
            </tr>
            <tr>
              <td>Signature format sai</td>
              <td>Ki·ªÉm tra th·ª© t·ª± params trong rawSignature</td>
            </tr>
            <tr>
              <td>Amount sai format</td>
              <td>D√πng s·ªë nguy√™n, KH√îNG nh√¢n 100</td>
            </tr>
            <tr>
              <td>Credentials sai</td>
              <td>Verify l·∫°i Partner Code, Access Key, Secret Key</td>
            </tr>
            <tr>
              <td>Callback URL kh√¥ng accessible</td>
              <td>ƒê·∫£m b·∫£o ngrok ƒëang ch·∫°y</td>
            </tr>
          </tbody>
        </table>

        <h3>üÜò C·∫ßn H·ªó Tr·ª£</h3>
        <div class="alert alert-info">
          <strong>VNPay Support:</strong><br>
          ‚Ä¢ Email: support@vnpay.vn<br>
          ‚Ä¢ Website: https://vnpay.vn<br><br>
          <strong>MoMo Support:</strong><br>
          ‚Ä¢ Email: merchant.care@momo.vn<br>
          ‚Ä¢ Hotline: 1900 636 652
        </div>
      </div>
    </div>
  </div>
</body>
</html>